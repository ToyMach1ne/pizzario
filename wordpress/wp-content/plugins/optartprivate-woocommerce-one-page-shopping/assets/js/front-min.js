(function($){$(document).ready(function(){$(window).load(function(){if($.cookie("ops_scroll_cookie")&&$.cookie("ops_scroll_cookie")!=="scroll_done"){var scroll_to=$.cookie("ops_scroll_cookie");if(scroll_to.length){$.scrollTo(scroll_to,{duration:'slow'})}$.removeCookie('ops_scroll_cookie',{path:'/'})}});function ajax_cart_sidebar(){var ajax_data={action:'ops_update_header'};ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;$.ajax({type:'post',url:ops_php_data.ajax_url,data:ajax_data,success:function(ajax_response){var sidebar=ops_php_data.sidebar_tag+ops_php_data.sidebar_attribute+ops_php_data.sidebar_attribute_value;var amount=ops_php_data.amount_tag+ops_php_data.amount_attribute+ops_php_data.amount_attribute_value;var contents=ops_php_data.contents_tag+ops_php_data.contents_attribute+ops_php_data.contents_attribute_value;if(ops_php_data.enable_cart_amount_update){$(sidebar+" "+amount).html($(ajax_response).filter('.amount').text())}if(ops_php_data.enable_cart_contents_update){$(sidebar+" "+contents).html($(ajax_response).filter('.contents').text())}}})};function ajax_request($element,ajax_data,update_cart,scroll_to,update_checkout){$element.block({message:null,overlayCSS:{background:'#fff',opacity:0.6}});$.ajax({type:'post',url:ops_php_data.ajax_url,data:ajax_data,success:function(response){$element.unblock();if(update_cart){$('#one-page-shopping-cart-content').html(response)}if(ops_php_data.display_cart){$('#one-page-shopping-cart').show()}else{$('#one-page-shopping-cart').hide()}if(update_checkout===true){var order_review=$('#order_review');if(order_review.length&&order_review.is(':visible')){$('body').trigger('update_checkout')}else{var ship_to_billing_val=$('#shiptobilling-checkbox').length?$('#shiptobilling-checkbox').is(':checked'):ops_php_data.ship_to_billing_def==='1';var ship_to_different_val=$('#ship-to-different-address-checkbox').length?$('#ship-to-different-address-checkbox').is(':checked'):ops_php_data.ship_to_different_def!=='0';$('#one-page-shopping-checkout').show();var checkout_ajax_data={action:'ops_update_checkout'};checkout_ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;$.ajax({type:'post',url:ops_php_data.ajax_url,data:checkout_ajax_data,success:function(checkout_response){if(checkout_response!=="-1"){$('#one-page-shopping-checkout-content').html(checkout_response);$('#shiptobilling-checkbox').attr('checked',ship_to_billing_val).change();$('#ship-to-different-address-checkbox').attr('checked',ship_to_different_val).change();if(scroll_to!==false&&scroll_to.length&&!ops_php_data.force_refresh){$('body').scrollTo(scroll_to,{duration:'slow'})}}else{if(scroll_to!==false&&scroll_to.length){$.cookie("ops_scroll_cookie",scroll_to,{expires:1,path:"/"});location.reload()}}}})}}if(ops_php_data.force_refresh){if(scroll_to!==false&&scroll_to.length){$.cookie("ops_scroll_cookie",scroll_to,{expires:1,path:"/"})}if($('#one-page-shopping-cart-content table').length===0&&update_cart){$('#one-page-shopping-checkout, #one-page-shopping-cart').hide();$.cookie("ops_scroll_cookie",'#page',{expires:1,path:"/"})}location.reload()}$('div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)').addClass('buttons_added');if($('#one-page-shopping-cart-content table').length===0&&update_cart&&!ops_php_data.force_refresh){$('#one-page-shopping-checkout, #one-page-shopping-cart').hide();$('body').scrollTo('#page',{duration:'slow'})}if(ops_php_data.enable_sidebar_update){ajax_cart_sidebar()}remove_unused_markup()}})};function remove_unused_markup(){for(var i=0;i<ops_php_data.remove_items.length;i++){$(ops_php_data.remove_items[i]).remove()}}if($('#one-page-shopping-cart-content table').length!==0||ops_php_data.cart_count>0){$('#one-page-shopping-checkout').show()}$('#one-page-shopping-checkout-content').on('change','#shiptobilling input',function(){$('div.shipping_address').hide();if(!$(this).is(':checked')){$('div.shipping_address').slideDown()}});$('#shiptobilling input').change();$('#one-page-shopping-checkout-content').on('change','#ship-to-different-address-checkbox',function(){$('div.shipping_address').hide();if($(this).is(':checked')){$('div.shipping_address').slideDown()}});$('#ship-to-different-address-checkbox').change();$('form.cart').on('click','.single_add_to_cart_button',function(event){if($(this).hasClass('disabled')){return}var ajax_data={action:'ops_add_to_cart',form:{}};var scroll_to=ops_php_data.display_cart?'#one-page-shopping-header':'#one-page-shopping-checkout-header',items=$(this).parents('form.cart').find('input[type!=radio][name], input[type=radio][name]:checked, select[name], textarea[name]');if($('.group_table').length){items.each(function(){var itemData=getInputData($(this));if(itemData.id!==undefined){if(ajax_data.form[itemData.id]===undefined){ajax_data.form[itemData.id]={}}ajax_data.form[itemData.id][itemData.name]=$(this).val()}})}else{var prodId=$('button[name=add-to-cart], input[name=add-to-cart]').val();items.each(function(){if(ajax_data.form[prodId]===undefined){ajax_data.form[prodId]={}}ajax_data.form[prodId][$(this).attr('name')]=$(this).val()})}ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;ajax_request($(event.target),ajax_data,ops_php_data.display_cart,scroll_to,true);return false});function getInputData($input){var nameParts=$input.attr('name').split('['),data={name:nameParts[0]};if(nameParts[1]!==undefined){data.id=nameParts[1].replace(']','')}return data}$('.products').on('click','.product_type_simple',function(event){event.preventDefault();var scroll_to=ops_php_data.display_cart?'#one-page-shopping-header':'#one-page-shopping-checkout-header',ajax_data={action:'ops_add_to_cart',form:{}};ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;var prod_id=$(this).data('product_id');ajax_data.form[prod_id]={};if(!$(this).attr('data-quantity')){ajax_data.form[prod_id]['quantity']="1"}else{ajax_data.form[prod_id]['quantity']=$(this).data('quantity')}ajax_request($(event.target),ajax_data,ops_php_data.display_cart,scroll_to,true);return false});$('.one-page-shopping-add-to-cart').on('click','.product_type_simple',function(event){event.preventDefault();var scroll_to=ops_php_data.display_cart?'#one-page-shopping-header':'#one-page-shopping-checkout-header',ajax_data={action:'ops_add_to_cart',form:{}};ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;var prod_id=$(this).data('product_id');ajax_data.form[prod_id]={};ajax_data.form[prod_id]['quantity']=$(this).data('quantity');ajax_request($(event.target),ajax_data,ops_php_data.display_cart,scroll_to,true);return false});$('.one-page-shopping-add-to-cart').on('click','.product_type_variation',function(event){event.preventDefault();var scroll_to=ops_php_data.display_cart?'#one-page-shopping-header':'#one-page-shopping-checkout-header',ajax_data={action:'ops_add_to_cart',form:{}};ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;var prod_id=$(this).data('product_id');ajax_data.form[prod_id]={};ajax_data.form[prod_id]['quantity']=$(this).data('quantity');var query=$(this).attr("href");var rest=query.split("?");var vars=rest[1].split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");ajax_data.form[prod_id][pair[0]]=pair[1]}ajax_request($(event.target),ajax_data,ops_php_data.display_cart,scroll_to,true);return false});$('div.related').on('click','.add_to_cart_button_ops',function(event){var ajax_data={action:'ops_add_to_cart_related',product_id:$(this).attr('data-product_id')};var scroll_to=ops_php_data.display_cart?'#one-page-shopping-header':'#one-page-shopping-checkout-header';ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;ajax_request($(event.target),ajax_data,ops_php_data.display_cart,scroll_to,true);return false});$('#one-page-shopping-cart-content').on('click','.product-remove > a',function(event){var parts=this.search.split('remove_item=');if(parts[1]!==undefined){parts=parts[1].split('&');if(parts[0]!==undefined){var ajax_data={action:'ops_remove_from_cart',cart_item:parts[0]};ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;ajax_request($(event.target).closest('form'),ajax_data,true,false,true);return false}}});$('#one-page-shopping-cart-content').on('click','input[name=update_cart]',function(event){var match,pattern=/\[(\w*)\]\[(\w*)\]/,ajax_data={action:'ops_update_cart',cart:new Object()};ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;$(this).parents('form').find('input[name^=cart]').each(function(){match=$(this).attr('name').match(pattern);if(match[2]!==undefined){if(ajax_data.cart[match[1]]===undefined){ajax_data.cart[match[1]]=new Object()}ajax_data.cart[match[1]][match[2]]=$(this).val()}});ajax_request($(event.target),ajax_data,true,false,true);return false});if(ops_php_data.display_checkout){$('#one-page-shopping-cart-content').on('click','input[name=proceed]',function(){$('body').scrollTo('#one-page-shopping-checkout-header',{duration:'slow'});return false})}$('#one-page-shopping-checkout-content').on('click','.woocommerce-remove-coupon',function(event){var ajax_data={action:'ops_remove_coupon'};ajax_data[ops_php_data.nonce_post_id]=ops_php_data.nonce;var parts=this.search.split('remove_coupon=');if(parts[1]!==undefined){ajax_data.coupon=parts[1];ajax_request($(event.target),ajax_data,false,false,true)}return false});remove_unused_markup();if(ops_php_data.display_cart&&($('#one-page-shopping-cart-content table').length!==0||ops_php_data.cart_count>0)){$('#one-page-shopping-cart').show()}else{$('#one-page-shopping-cart').hide()}})})(jQuery);
